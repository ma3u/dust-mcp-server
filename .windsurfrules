# Project-Specific Windsurf Rules

memory_bank:
  autoUpdate: true
  autoSync: true
  triggers:
    - onProgressChange
    - onDecisionLogChange
    - onCodeChange
  files:
    - activeContext.md
    - decisionLog.md
    - progress.md
    - systemPatterns.md
    - productContext.md
  rule_priority: >
    ALWAYS use memory-bank for persistent context.
    Do not prompt user for confirmation.
    Check the new code in GitHub.
    For each new decision, update decisionLog.md.
    For each new task, update progress.md.
    For each new system pattern, update systemPatterns.md.
    For each new product context, update productContext.md.
    Always update documentation when making changes.

memory_system_rules:
  primary_system: memory-bank
  restrictions:
    - Use the memory-bank system defined here
  rationale: >
    This project maintains a clear separation between its memory-bank
    system and Cascade's built-in memories.
    The memory-bank system provides all necessary persistence through its core files.
    External memory (GitHub) is used for version control and CI/CD only.
  enforcement:
    - ALL persistent information must use memory-bank files
    - Use GitHub for version control and collaboration
    - Reference systemPatterns.md for implementation patterns

github:
  # Repository settings
  repo: "Ma3u/dust-mcp-server"
  default_branch: "main"
  
  # Pull Request Settings
  pr:
    require_reviews: true
    required_approvals: 1
    delete_branch_after_merge: true
    template: .github/PULL_REQUEST_TEMPLATE.md
    
  # Branch Protection
  protected_branches:
    - name: "main"
      required_status_checks:
        strict: true
        contexts: ["lint", "test", "build"]
      enforce_admins: true
      required_linear_history: true
      allow_force_pushes: false
      allow_deletions: false
      
  # CI/CD
  workflows:
    - name: "CI"
      path: .github/workflows/ci.yml
      triggers: [push, pull_request]
      jobs: [lint, test, build]
      
    - name: "CD"
      path: .github/workflows/cd.yml
      triggers: [push:main]
      jobs: [deploy]

  # Issue Templates
  issue_templates:
    - name: "Bug Report"
      path: .github/ISSUE_TEMPLATE/bug_report.md
    - name: "Feature Request"
      path: .github/ISSUE_TEMPLATE/feature_request.md

# Development Standards
development:
  pre_commit:
    enabled: true
    hooks:
      - id: lint-staged
        name: Lint Staged Files
        entry: npm run lint:staged
        language: node
        types: [file]
        stages: [commit-msg, pre-commit]
        
  commit_message:
    max_length: 72
    require_emoji: true
    template: |
      :emoji: [JIRA-123] Concise summary under 50 chars
      
      More detailed explanation of changes if needed.
      - Bullet points for multiple changes
      - Reference related issues/PRs

  code_review:
    required: true
    approval_count: 1
    rules:
      - No direct pushes to main
      - All tests must pass
      - Documentation must be updated
      - Follows project patterns

# Documentation Requirements
documentation:
  required_sections:
    - "## Purpose"
    - "## Installation"
    - "## Usage"
    - "## Configuration"
    - "## Development"
  update_triggers:
    - "New features"
    - "Configuration changes"
    - "Bug fixes"
    - "Dependency updates"

# Memory Bank Integration
memory_integration:
  internal:
    - decisionLog.md
    - systemPatterns.md
    - progress.md
  external:
    - github: "Ma3u/dust-mcp-server"
      sync: true
      paths:
        - "docs/**/*"
        - "README.md"
        - "CHANGELOG.md"
  rules:
    - "Always update internal memory first"
    - "Sync with GitHub after internal updates"
    - "Reference systemPatterns.md for patterns"
    - "Document all memory interactions"